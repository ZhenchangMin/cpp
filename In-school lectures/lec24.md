# Lec24: 函数式程序设计
## 程序设计范式
如何看待和组织算法和数据存在着不同的做法，从而形成不同的**程序设计范式**

### 命令式程序设计范式
命令式程序设计范式是指：
针对一个目标，需要给出达到目标的**操作步骤**，即要对“如何做”进行详细描述。
它们与冯诺依曼体系结构一致，是使用较广泛的程序设计范式，适合于解决大部分的实际应用问题。
命令式程序设计范式的典型代表：
- 过程式程序设计
- 面向对象程序设计

### 声明式程序设计范式
声明式程序设计范式是指：
只需要**给出目标**，不需要对如何达到目标（操作步骤）进行描述，即只需要对“做什么”进行描述。
有良好的数学理论支持，易于保证程序的**正确性**，并且，设计出的程序比较精炼和具有潜在的并行性。
声明式程序设计范式的典型代表：
- 函数式程序设计
- 逻辑式程序设计

## 函数式程序设计
函数式程序设计（functional programming）是指把程序组织成一组数学函数，计算过程体现为基于一系列函数应用（把函数作用于数据）的表达式求值。
函数也被作为**值**（数据）来看待，函数的参数和返回值也可以是函数，因此，可以对函数进行组合，形成高阶函数。
基于的理论是**递归函数理论**和**lambda演算**。

- **递归**是主要的控制结构，通常不使用赋值语句和循环（迭代）语句。
- 表达式的**惰性（延迟）求值**（Lazy evaluation），一个表达式只有需要用到它的值的时候**才会去计算它**。

## 函数式程序设计的基本手段
### 递归
在函数式编程中，重复操作不采用迭代（循环），而是采用递归。
由于函数递归调用深度要受栈空间的限制，并且递归调用效率低，因此，函数式编程常采用**尾递归**，递归调用是函数执行的**最后一步操作**，递归调用回来不再做其它事了。

尾递归便于编译程序优化，并且可以自动转换为迭代，从而避免栈溢出问题。

### 过滤、映射和归约
函数式编程中常用的三种高阶函数操作：
- 过滤（filter）：根据给定的条件函数，从一个集合中选出满足某条件的元素选出来，构成一个新的集合。
- 映射（map）：根据给定的映射函数，把一个集合中的每个元素都映射到另一个元素，构成一个新的集合。
- 归约（reduce）：对一个集合中的所有元素连续进行某个操作，最后得到一个值。

### 部分函数应用
对于一个多参数的函数，在某些应用场景下，它的一些参数往往取固定的值。例如，对于下面的print函数：
void print(int n,int base); //按base指定的进制输出n
大部分情况下，base都是取10：
print(x,10)
部分函数应用是指：对一个多参数的函数，只给它的某些参数提供值，从而生成一个新函数，该新函数不包含原函数中已提供值的参数。
这样就可以简化函数调用。

### 柯里化
柯里化是指把一个多参数的函数变换成一系列单参数的函数，它们分别接收原函数的第一个参数、第二个参数、......，直到所有参数都被接收完毕，最后返回结果。
例如，对于下面带两个参数的函数add：
int add(int x,int y) { return x+y; }
可把它柯里化成两个单参数的函数：
第一个函数是add_cd，它的参数为函数add的第一个参数x。
第二个函数是add_cd返回的函数，它的参数为函数add的第二个参数y。
```cpp
function<int (int)>  add_cd(int x) //返回值是个单参数函数
//或者，auto add_cd(int x)
{ return bind(add,x,_1);
   //或
   return [x](int y)->int { return add(x,y); };
}
......
cout << add_cd(1)(2); //add_cd实际代表了一个函数链
//等价于：
cout << add(1,2);
```
利用函数的柯里化，也可以缩小一个函数的适用范围，提高函数的针对性。