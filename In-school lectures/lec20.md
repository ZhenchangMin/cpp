# Lec20: 输入/输出
## 概述
输入输出简称I/O，是程序的重要组成部分
由具体的**标准库**的功能来提供
输入/输出操作往往是带**内存缓冲区**的，解决内存与外设存取速度不匹配问题，提高效率：
- 输出时，输出的数据先放内存缓冲区中，缓冲区**满了之后再实际输出到外设**。
- 输入时，先从外设输入一大块内容**放入内存缓冲区**，然后从缓冲区中**逐步输入**数据。

### printf、scanf的缺陷
过程式，从C语言的函数库保留而来的
printf和scanf是两个带可变参数的函数，它们的第一个参数为一个格式串，指出后面要输入/输出的**数据的类型和个数**。
类型不安全，可能导致类型或者个数不一致，造成运行错误

### cin、cout的优势
面向对象的输入输出，用相应的输入输出类和重载过后的`<<`和`>>`实现
不需要专门指定数据的类型和个数，**编译时刻**根据数据本身来决定数据的类型和个数，可以避免与类型和个数相关的错误

### I/O的分类
- 面向控制台的I/O，从标准输入设备（键盘）获得数据，运行结果从标准输出设备（显示器）输出
- 面向文件的I/O，从外存（磁盘）获得数据，运行结果保存在外存中
- 面向字符串变量的I/O，从程序中的字符串变量获得数据，把运行结果保存到字符串变量中

### C++的I/O类库中基本的类
![1762754770162](image/lec20/1762754770162.png)
istream只能输入，ostream只能输出
想要既能输入又能输出，就需要iostream这个类，是从istream和ostream**多继承**而来的

#### 基于I/O类库进行I/O的**基本步骤**
首先要创建某个I/O类的一个**对象**，然后，调用该对象类的**成员函数**进行基于**字节流**的输入/输出操作。

比如控制台输入：
```cpp
istream in(...); //创建istream类的一个对象in
in.get(ch); //读入一个字节，ch为一个字符变量
in.read(p,100); //每次读入100个字节，放入p中，p是内存空间首地址
```
控制台输出：
```cpp
ostream out(...); //创建ostream类的一个对象out
out.put(ch); //输出一个字节，ch为一个字符变量
out.write(p,100); //把p指向的内存中100个字节输出
```

标准库中的I/O类还针对输入/输出类分别重载了操作符`>>`（抽取）和`<<`（插入），用它们可以进行C++基本类型数据的输入/输出操作。
```cpp
//控制台输入
istream in(...);
in >> x; //x是一个基本数据类型的变量
in >> y; //y是一个基本数据类型的变量
//控制台输出
ostream out(...);
out << e1; //e1是一个表达式
out << e2; //e2是一个表达式
```
用操作符`>>`进行输入时，它把输入的内容看成是一个**字符串**，会自动进行从字符串到基本数据类型的**转换**。
用操作符`<<`进行输出时，它会把基本数据类型的数据**转换成字符串输出**。

## 面向控制台的I/O
在I/O类库中**预定义**了四个I/O对象，可以直接用来进行**控制台的输入/输出操作**
- cin：istream类的对象，对应**标准输入设备**
- cout：ostream类的对象，对应**标准输出设备**
- cerr和clog：ostream类的对象，对应着计算机系统用于输出**特殊信息**（如程序错误信息）的设备。（通常也对应着显示器，但不受**输出重定向**的影响）。cerr为不带缓冲的，clog为带缓冲的。

在进行控制台输入/输出时，程序中需要有 `#include <iostream>` 这个命令

输入/输出重定向：`C>program.exe <a.txt >b.txt`
程序中所有cin从文件a.txt中获得输入，<号代表输入的文件
程序中所有cout输出到文件b.txt中，>号代表输出的文件

### 控制台的输出操作
用插入操作符`<<`进行基本数据类型数据的输出
特殊情况：输出**指向字符的指针**时，并不是输出指针的值（地址），而是输出它指向的字符串。
如果要输出字符指针的值，需要把它转换成其它类型的指针，比如转换成void *类型

#### 输出格式控制
可以通过输出一些**操纵符**（manipulator）来实现
```cpp
#include <iostream>
#include <iomanip>  //操纵符声明的头文件。
using namespace std;
.....
int x=10;
cout << hex << x << endl; //以十六进制输出x的值，然后换行。
```
![1762755853959](image/lec20/1762755853959.png)
